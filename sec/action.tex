
\section{An \texorpdfstring{$E_\infty$}{E-infty}-structure on cubical chains} \label{s:action}

In this section we construct a natural $\M$-bialgebra structure on the chains of standard cubes.
These are determined by three natural linear maps satisfying the relations defining $\mathcal M$.
A Kan extension argument then provides the chains of any cubical set with a natural $\UM$-coalgebra structure.
We begin by recalling the basics of cubical topology.

\subsection{Cubical sets}

The \textit{cube category} $\cube$ is the full subcategory of $\Cat$ with objects $2^n = (0 \to 1)^n$, the iterated products of a poset category and $2^0 = \{0\}$.
The morphisms of the cube category are generated by the \textit{coface} and \textit{codegeneracy functors} defined by
\begin{align*}
\delta_i^\varepsilon & = \mathrm{id}_{2^{i-1}} \times \delta^\varepsilon \times \mathrm{id}_{2^{n-1-i}} \colon 2^{n-1} \to 2^n, \\
\sigma_i & = \mathrm{id}_{2^{i-1}} \times \, \sigma \times \mathrm{id}_{2^{n-i}} \quad \colon 2^{n} \to 2^{n-1},
\end{align*}
where $\varepsilon \in \{0,1\}$ and the functors
\[
\begin{tikzcd} [column sep=16pt]
2^0 \arrow[r, bend left, "\delta^0"] \arrow[r, bend right, "\delta^1"'] & 2^1 \arrow[r, "\sigma"] & 2^0
\end{tikzcd}
\]
are defined by
\[
\delta^0(0) = 0, \qquad \delta^1(0) = 1, \qquad \sigma(0) = \sigma(1) = 0.
\]
We refer to \cite{grandis2003cubical} for a more leisure exposition and for variations on this definition.

We denote by $\cube_{\deg}(2^m, 2^n)$ the subset of morphism in $\cube(2^m, 2^n)$ of the form $\sigma_i \circ \tau$ with $\tau \in \cube(2^m, 2^{n+1})$.

The category of \textit{cubical sets} is the functor category $\cSet = \Fun(\cube^\op, \Set)$.
The \textit{standard $n$-cube} is the cubical set $\cube^n = \cube(-, 2^n)$, and the \textit{Yoneda embedding} $\cube \to \cSet$ is the functor induced by $2^n \mapsto \cube^n$.

For any cubical set $X$ we have
\[
X_n \cong \colim_{\cube^n \to X} \cube^n,
\]
and we denote $X(\delta_i^\varepsilon)$ and $X(\sigma_i)$ by $d_i^\varepsilon$ and $s_i$.

\subsection{Cubical chains}

The functor of \textit{chains} $\chains \colon \cSet \to \Ch$ is the Kan extension along the Yoneda embedding of the functor $\cube \to \Ch$ assigning to an object $2^n$ the chain complex having in degree $m$ the $\k$-module
\[
\frac{R\{\cube(2^m, 2^n)\}}{R\{\cube_{\deg}(2^m, 2^n)\}}
\]
and boundary map defined by
\[
\partial (\id_{2^n}) = \sum_{i=1}^{n} \ (-1)^i \
\big(\delta_i^1 - \delta_i^0 \big),
\]
and to a morphism $\tau \colon 2^n \to 2^{n^\prime}$ the chain map
\[
\begin{tikzcd}[row sep=-3pt, column sep=normal,
/tikz/column 1/.append style={anchor=base east},
/tikz/column 2/.append style={anchor=base west}]
\chains_m(\cube^n) \arrow[r] &  \chains_m(\cube^{n^\prime}) \\
(2^m \to 2^n) \arrow[r, mapsto] & (2^m \to 2^n \stackrel{\tau}{\to} 2^{n^\prime}).
\end{tikzcd}
\]

\subsection{Cubical singular complex}

Consider the topological $n$-cube
\[
\gcube^{n} = \{(x_1, \dots, x_n) \mid x_i \in [0,1]\}.
\]
The assignment $2^n \to \gcube^n$ defines a functor $\cube \to \Top$ whose Kan extension is known as \textit{geometric realization}.
It has a right adjoint $\cSing \colon \Top \to \cSet$ given by
\[
Z \to \Big(2^n \to \Top(\gcube^n, X)\Big)
\]
and referred to as the \textit{cubical singular complex} of the topological space $Z$.
The chain complex $\chains(\cSing Z)$ is referred to as the \textit{cubical singular chains} of $Z$.

\subsection{Cellular chains}

The chain complex $\chains(\cube^n)$ is by definition equal to $\chains(\cube^1)^{\otimes n}$, which is isomorphic to the chain complex $C(\gcube^1)^{\otimes n}$, where $C(\gcube^1)$ is the complex of cellular chains on the standard interval.
We will use the notation $x_1 \otimes \cdots \otimes x_n$ with $x_i \in \{[0], [0,1], [1]\}$ for the elements in its basis, and we remark that this chain complex is also isomorphic to $\gchains(\gcube^n)$, the cellular chains of the geometric $n$-cube with its standard CW structure.

\subsection{Serre coalgebra} \label{ss:serre coalgebra}

We now recall a natural (counital and coassociative) coalgebra structure on cubical chains studied by Cartan and Serre, inducing the cup product in the cohomology of cubical sets.

Using a Kan extension along the Yoneda embedding, it suffices to equip the chains on standard cubes with a natural coalgebra structure.
For any $n \in \N$, define $\epsilon \colon \chains(\cube^n) \to \k$ by
\[
\epsilon \left( x_1 \otimes \dots \otimes x_d \right) = \epsilon(x_1) \dotsm \epsilon(x_n),
\]
where
\[
\epsilon([0]) = \epsilon([1]) = 1, \qquad \epsilon([0, 1]) = 0,
\]
and $\Delta \colon \chains(\cube^n) \to \chains(\cube^n)^{\otimes 2}$ by
\[
\Delta (x_1 \otimes \dots \otimes x_n) =
\sum \pm \left( x_1^{(1)} \otimes \dots \otimes x_n^{(1)} \right) \otimes
\left( x_1^{(2)} \otimes \dots \otimes x_n^{(2)} \right),
\]
where the sign is determined using the Koszul convention, and we are using Sweedler's notation
\[
\Delta(x_i) = \sum x_i^{(1)} \otimes x_i^{(2)}
\]
for the chain map $\Delta \colon \chains(\cube^1) \to \chains(\cube^1)^{\otimes 2}$ defined by
\[
\Delta([0]) = [0] \otimes [0], \quad \Delta([1]) = [1] \otimes [1], \quad \Delta([0,1]) = [0] \otimes [0,1] + [0,1] \otimes [1].
\]

We remark that, using the canonical isomorphism $\chains(\cube^n) \cong \chains(\cube^1)^{\otimes n}$, the coproduct $\Delta$ can be described as the composition
\[
\begin{tikzcd}
\chains(\cube^1)^{\otimes n} \arrow[r, "\Delta^{\otimes n}"] & \left( \chains(\cube^1)^{\otimes 2} \right)^{\otimes n} \arrow[r, "sh"] & \left( \chains(\cube^1)^{\otimes n} \right)^{\otimes 2}
\end{tikzcd}
\]
where $sh$ is the shuffle map that places tensor factors in odd position first.

\subsection{Degree 1 product}

For $n \in \mathbb{N}$, define the \textit{product} $\ast \in \Hom(\chains(\square^n)^{\otimes 2}, \chains(\square^n))$ by
\begin{align*}
(x_1 \otimes \cdots \otimes x_n) \ast (y_1 \otimes \cdots \otimes y_n) =
(-1)^{|x|} \sum_{i=1}^n x_{<i}\, \epsilon(y_{<i}) \otimes x_i \ast y_i \otimes \epsilon(x_{>i}) \, y_{>i},
\end{align*}
where
\begin{align*}
x_{<i} & = x_1 \otimes \cdots \otimes x_{i-1}, &
y_{<i} & = y_1 \otimes \cdots \otimes y_{i-1}, \\
x_{>i} & = x_{i+1} \otimes \cdots \otimes x_n, &
y_{>i} & = y_{i+1} \otimes \cdots \otimes y_n,
\end{align*}
with the convention
\[
x_{<1} = y_{<1} = x_{>n} = y_{>n} = 1 \in \Z,
\]
and the only non-zero values of $x_i \ast y_i$ are
\[
\ast([0] \otimes [1]) = [0, 1], \qquad  \ast([1] \otimes [0]) = -[0, 1].
\]

\subsection{An \texorpdfstring{$E_\infty$}{E-infty}-structure on cubical chains} \label{ss:main construction}

The following is the main technical result of this paper.

\begin{lemma} \label{l:cubical chain bialgebra}
	The assignment
	\[
	\counit \mapsto \epsilon, \quad \coproduct \mapsto \Delta, \quad \product \mapsto \ast,
	\]
	induces natural $\mathcal M$-bialgebra structure on $\chains(\square^n)$ for every $n \in \mathbb{N}$, or, equivalently, a functor $\cube \to \biAlg_{\M}$.
\end{lemma}

The category of bialgebras over a prop is in general not cocomplete, but those of algebras and coalgebras over operads are.
So we have the following result, the main contribution of this paper.

\begin{theorem} \label{t:lift to e infinity coalgebras}
	Composing the functor defined in \cref{l:cubical chain bialgebra} with the forgetful functor $\biAlg_{\M} \to \coAlg_{\UM}$ defines a functor $\cube \to \coAlg_{\UM}$ whose Kan extension endows the chains of a cubical set with a natural $E_\infty$-coalgebra structure extending the Serre coproduct.
\end{theorem}

By linear duality, the same argument can be used to define a natural $E_\infty$-algebra structure on cubical cochains extending the Serre product.


\subsection{Proof of \cref{l:cubical chain bialgebra}} \label{ss:proof action}

We need to show that the assignment
\[
\counit \mapsto \epsilon, \quad \coproduct \mapsto \Delta, \quad \product \mapsto \ast,
\]
is compatible with the relations
\[
\productcounit = 0,
\qquad
\leftcounitality = 0,
\qquad
\rightcounitality = 0,
\]
and
\[
\partial\ \counit = 0,
\hspace*{.6cm}
\partial\ \coproduct = 0,
\hspace*{.6cm}
\partial\ \product = \ \boundary\,.
\]
For the rest of this proof let us consider two basis elements of $N_\bullet(\square^n) = N_\bullet(\square^1)^{\otimes n}$
\begin{align*}
x = x_1 \otimes \cdots \otimes x_n
\qquad \text{ and } \qquad
y = y_1 \otimes \cdots \otimes y_n.
\end{align*}
Since the degree of $\ast$ is $1$ and $\epsilon([0,1]) = 0$, we can verify the first relation easily:
\begin{align*}
\varepsilon(x \ast y) & =
\sum (-1)^{|x|} \epsilon(y_{<i}) \epsilon(x_{<i}) \otimes \epsilon(x_i \ast y_i) \otimes \epsilon(x_{>i}) \epsilon(y_{>i}) = 0.
\end{align*}
For the second relation we want to show that $(\epsilon \otimes \id) \circ \Delta = \id$.
Since
\begin{gather*}
(\epsilon \otimes \id) \circ \Delta([0]) = \epsilon([0]) \otimes [0] = [0], \qquad
(\epsilon \otimes \id) \circ \Delta([1]) = \epsilon([1]) \otimes [1] = [1], \\
(\epsilon \otimes \id) \circ \Delta([0, 1]) = \epsilon([0]) \otimes [0, 1] + \epsilon([0, 1]) \otimes [1] = [0,1],
\end{gather*}
we have
\begin{align*}
(\epsilon \otimes \id) \circ \Delta (x_1 \otimes \cdots \otimes x_n) &=
\sum \pm \left( \epsilon \big(x_1^{(1)}\big) \otimes \cdots \otimes \epsilon\big(x_n^{(1)}\big) \right) \otimes
\left( x_1^{(2)} \otimes \cdots \otimes x_n^{(2)} \right), \\ &=
x_1 \otimes \cdots \otimes x_n,
\end{align*}
where the sign is obtained by noticing that the only non-zero term occurs when each factor $x_i^{(0)}$ is of degree $0$.
The third relation is verified analogously.
The fourth is precisely the fact that $\epsilon$ is a chain map.
We will verify that $\Delta$ is a chain map recalling two facts: 1) the map $\Delta$ is equal to the composition
\[
\begin{tikzcd}
\chains(\square^1)^{\otimes n} \arrow[r, "\Delta^{\!\otimes n}"] &
\left( \chains(\square^1)^{\otimes 2} \right)^{\otimes n} \arrow[r, "sh"] &
\left( \chains(\square^1)^{\otimes n} \right)^{\otimes 2},
\end{tikzcd}
\]
and, 2) the tensor product of chain maps is a chain map.
Since $\Delta$ on $\chains(\cube^1)$ can be easily verified to be a chain map, the fifth relation follows.
To verify the sixth and final relation we need to show that
\[
\partial (x \ast y)\ +\ \partial x \ast y\ +\ (-1)^{|x|}x \ast \partial y\ =\ \epsilon(x) y \ -\ \epsilon(y) x.
\]
We have
\[
x \ast y = \sum (-1)^{|x|} x_{<i} \, \epsilon(y_{<i}) \otimes x_i \ast y_i \otimes \epsilon(x_{>i})\, y_{>i}
\]
and
\begin{align*}
\partial(x \ast y) & =
\sum (-1)^{|x|} \, \partial x_{<i}\, \epsilon(y_{<i}) \otimes x_i \ast y_i \otimes \epsilon(x_{>i})\, y_{>i} \\ & +
\sum (-1)^{|x|+|x_{<i}|} \, x_{<i}\, \epsilon(y_{<i}) \otimes \partial (x_i \ast y_i) \otimes \epsilon(x_{>i}) \, y_{>i} \\ & -
\sum (-1)^{|x|+|x_{<i}|} \, x_{<i}\, \epsilon(y_{<i}) \otimes x_i \ast y_i \otimes \epsilon(x_{>i})\, \partial y_{>i}.
\end{align*}
Since
\[
|x| = |x_{<i}| + |x_i| + |x_{>i}|, \quad \epsilon(x_{>i}) \neq 0 \Leftrightarrow |x_{>i}| = 0, \quad \partial(x_i \ast y_i) \neq 0 \Rightarrow |x_i| = 0,
\]
we have
\begin{equation} \label{e:boundary of product 1}
\begin{split}
\partial(x \ast y) & =
\sum (-1)^{|x|} \, \partial x_{<i}\, \epsilon(y_{<i}) \otimes x_i \ast y_i \otimes \epsilon(x_{>i})\, y_{>i} \\ & +
\sum x_{<i} \, \epsilon(y_{<i}) \otimes \partial (x_i \ast y_i) \otimes \epsilon(x_{>i})\, y_{>i} \\ & -
\sum x_{<i} \, \epsilon(y_{<i}) \otimes x_i \ast y_i \otimes \epsilon(x_{>i})\, \partial y_{>i}.
\end{split}
\end{equation}
We also have
\begin{align*}
\partial x \ast y & =
\sum (-1)^{|x|-1} \, \partial x_{<i}\, \epsilon(y_{<i}) \otimes x_i \ast y_i \otimes \epsilon(x_{>i}) \, y_{>i} \\ & +
\sum (-1)^{|x|-1+|x_{<i}|} \, x_{<i}\, \epsilon(y_{<i}) \otimes \partial x_i \ast y_i \otimes \epsilon(x_{>i}) \, y_{>i} \\ & +
\sum (-1)^{|x|-1+|x_{<i}|} \, x_{<i}\, \epsilon(y_{<i}) \otimes x_i \ast y_i \otimes \epsilon(\partial x_{>i}) \, y_{>i}.
\end{align*}
Since
\[
\epsilon(\partial x_{>i}) = 0, \quad \partial x_i \neq 0 \Leftrightarrow |x_i| = 1,
\]
we have
\begin{equation} \label{e:boundary of product 2}
\begin{split}
\partial x \ast y & =
\sum (-1)^{|x|-1} \, \partial x_{<i}\, \epsilon(y_{<i}) \otimes x_i \ast y_i \otimes \epsilon(x_{>i})\, y_{>i} \\ & +
\sum x_{<i}\, \epsilon(y_{<i}) \otimes \partial x_i \ast y_i \otimes \epsilon(x_{>i})\, y_{>i}.
\end{split}
\end{equation}
We also have
\begin{align*}
(-1)^{|x|} \, x \ast \partial y & =
\sum x_{<i} \, \epsilon(\partial y_{<i}) \otimes x_i \ast y_i \otimes \epsilon(x_{>i})\, y_{>i} \\ & +
\sum (-1)^{|y_{<i}|} \, x_{<i}\, \epsilon(y_{<i}) \otimes x_i \ast \partial y_i \otimes \epsilon(x_{>i}) \, y_{>i} \\ & +
\sum (-1)^{|y_{<i}| + |y_i|} \, x_{<i}\, \epsilon(y_{<i}) \otimes x_i \ast y_i \otimes \epsilon(x_{>i}) \, \partial y_{>i},
\end{align*}
which is equivalent to
\begin{equation} \label{e:boundary of product 3}
\begin{split}
(-1)^{|x|} \, x \ast \partial y & =
\sum x_{<i} \, \epsilon(y_{<i}) \otimes x_i \ast \partial y_i \otimes \epsilon(x_{>i})\, y_{>i} \\ & +
\sum x_{<i}\, \epsilon(y_{<i}) \otimes x_i \ast y_i \otimes \epsilon(x_{>i})\, \partial y_{>i}.
\end{split}
\end{equation}
Putting identities \eqref{e:boundary of product 1}, \eqref{e:boundary of product 2} and \eqref{e:boundary of product 3} together, we get
\begin{align*}
\partial (x \otimes y) \ +\ & \partial x \ast y\ +\, (-1)^{|x|}x \ast \partial y \\
& = \sum \epsilon(y_{<i})\, x_{<i} \otimes \big(\partial(x_i \ast y_i) + \partial x_i \ast y_i + x_i \ast \partial y_i\big) \otimes \epsilon(x_{>i})\, y_{>i}.
\end{align*}
Since
\begin{align*}
\partial(x_i \ast y_i)\ +\ \partial x_i \ast y_i\ +\ x_i \ast \partial y_i =
\epsilon(x_i)y_i\ -\ \epsilon(y_i)x_i,
\end{align*}
we have
\begin{align*}
\partial (x \ast y) \ +\ \partial x \ast y\ +\ & (-1)^{|x|}x \ast \partial y \\ = \ &
\sum \epsilon(y_{<i}) \, x_{<i} \otimes \epsilon(x_{\geq i}) y_{\geq i}\ -\
\epsilon(y_{\leq i}) \, x_{\leq i} \otimes \epsilon(x_{>i}) y_{>i} \\ = \ &
\epsilon(x)y - \epsilon(y)x,
\end{align*}
as desired, where the last equality follows from a telescopic sum argument.